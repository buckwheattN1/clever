{% extends 'main.html' %}
{% load static %}
{% block content %}
{% if request.user.is_staff %}
<div class="row">
  <div class="col">
    {% if request.user.is_superuser %}
    <a href="{% url 'search-payment' %}" class="btn btn-primary btn-sm float-center mt-3 mb-3">Szukaj rekordu</a>
    
    <br>
    {% endif %}
  </div>
</div>

{% if request.user == cash.user or request.user.is_superuser %}
<div class="row">
  <div class="col-sm-12">
    <div class="card">
      <div class="card-body">
        <a href="{% url 'create-payment' cash.id %}" class="btn btn-danger btn-sm mt-3 mb-3">Dodaj rekord</a>
        <a href="{% url 'cash-report' cash.id %}" class="btn btn-warning btn-sm mt-3 mb-3 float-end">Raport dobowy</a>
        <div class="card-title">
          
          <small> 
            <p class="float-start">{{ cash.title }} </p>
            <!-- <a href="" class="btn btn-danger btn-sm">Raport tygodniowy</a>
            <a href="" class="btn btn-danger btn-sm">Raport miesięczny</a> -->
            <h6 class="float-end {% if cash.amount > 0 %} text-success {% else %} text-danger {% endif %}">Saldo: {{cash.amount }} zł</h6>
          </small>
          <table class="table table-sm text-center  me-2 ">
            <thead>
              <tr>
                <td>ID</td>
                <td>Data <br> Użytkownik</td>
                <td>Tytułem</td>
                <td>Nr wew.</td>
                <td>IW/IY</td>
                <td>Kwota</td>
                <td>Saldo</td>
                <td>Status</td>
                <td colspan="2">Akcja</td>
              </tr>
            </thead>
            <tbody>
              {% for payment in cash.payment_set.all %}
              <tr class="{% if payment.status != 0 %} table-success {% else %} table-danger {% endif %}">
                <td>{{ payment.id_number }}</td>
                <td>{{ payment.date|date:'d/m/y' }}<br>{{ request.user.first_name }} {{ request.user.last_name|first }}.</td>
                <td>{{ payment.title }}</td>
                <td>{{ payment.number }}</td>
                <td>{{ payment.IW_IY }}</td>
                <td class="{% if payment.amount > 0 %} text-success {% else %} text-danger {% endif %}">{{ payment.amount }}zł</td>
                <td>{{ payment.cash_amount }}zł</td>
                <td>{{ payment.get_status_display }}</td>
                <td>
                  {% if payment.status == 0 %}
                  <a href="{% url 'delete-payment' payment.id %}" class="btn btn-danger btn-sm">Usuń</a>
                  {% endif %}
                </td>
                <td>
                  {% if request.user.is_superuser %}
                  <a href="{% url 'update-payment' payment.id %}" class="btn btn-success btn-sm">Szczegóły</a>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
              {% endif %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

{% endif %}
{% endblock %}